/trees:
  get:
    summary: Get trees
    operationId: getTrees
    parameters:
      - name: page[number]
        in: query
        description: Page number for pagination
        schema:
          type: integer
      - name: page[size]
        in: query
        description: Number of records per page for pagination
        schema:
          type: integer
      - name: sort
        in: query
        description: Comma-separated field names to sort by. Use -<fieldname> for descending order.
        schema:
          type: string
      - name: filter
        in: query
        description: Field to filter by, in the format filter[<fieldname>][<operator>]=<value>. Operators can be eq (equals), gt (greater than), lt (less than), gte (greater than or equals), lte (less than or equals), ne (not equals).
        style: deepObject
        explode: true
        schema:
          type: object
          additionalProperties:
            type: object
            additionalProperties:
              type: string
    responses:
      '200':
        description: A list of trees
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/TreesResponse'
            example:
              data:
                - id: d1076e5e-603e-4eb8-9b2e-82b36414a8dd
                  type: tree
                  attributes:
                    name: My Tree
                    description: An example tree
                    createdAt: 2020-01-01T00:00:00.000Z
                    updatedAt: 2020-01-01T00:00:00.000Z
                    owner: 6ca0bd34-0f36-4670-8e1e-574011ee9ba4
                    isPrivate: false
                    isDeleted: false
                    forks: 0
                  relationships:
                    messages:
                      links:
                        related: /trees/d1076e5e-603e-4eb8-9b2e-82b36414a8dd/messages
                - id: 23e28116-0696-4e2c-a606-dcc723e1a3cc
                  type: tree
                  attributes:
                    name: My Favorite Tree
                    description: Another example tree
                    createdAt: 2020-01-01T00:00:00.000Z
                    updatedAt: 2020-01-01T00:00:00.000Z
                    owner: 6ca0bd34-0f36-4670-8e1e-574011ee9ba4
                    isPrivate: false
                    isDeleted: false
                    forks: 0
                  relationships:
                    messages:
                      links:
                        related: /trees/23e28116-0696-4e2c-a606-dcc723e1a3cc/messages
              links:
                self: /trees?page[number]=1&page[size]=10
                first: /trees?page[number]=1&page[size]=10
                last: /trees?page[number]=1&page[size]=10
                prev: null
                next: null
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
  post:
    summary: Create a new tree
    operationId: createTree
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/CreateTreeRequest'
          example:
            data:
              type: tree
              attributes:
                name: My Favorite Tree
                description: Another example tree
                isPrivate: false
    responses:
      '201':
        description: A created tree
        headers:
          Location:
            schema:
              type: string
            description: The url of the newly created tree
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/TreeResponse'
            example:
              data:
                id: 23e28116-0696-4e2c-a606-dcc723e1a3cc
                type: tree
                attributes:
                  name: My Favorite Tree
                  description: Another example tree
                  createdAt: 2020-01-01T00:00:00.000Z
                  updatedAt: 2020-01-01T00:00:00.000Z
                  owner: 6ca0bd34-0f36-4670-8e1e-574011ee9ba4
                  isPrivate: false
                  isDeleted: false
                  forks: 0
                relationships:
                  messages:
                    links:
                      related: /trees/23e28116-0696-4e2c-a606-dcc723e1a3cc/messages
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
/trees/{treeId}:
  get:
    summary: Get a tree
    operationId: getTree
    parameters:
      - name: treeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: A tree
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/TreeResponse'
            example:
              data:
                id: d1076e5e-603e-4eb8-9b2e-82b36414a8dd
                type: tree
                attributes:
                  name: My Tree
                  description: An example tree
                  createdAt: 2020-01-01T00:00:00.000Z
                  updatedAt: 2020-01-01T00:00:00.000Z
                  owner: 6ca0bd34-0f36-4670-8e1e-574011ee9ba4
                  isPrivate: false
                  isDeleted: false
                  forks: 0
                relationships:
                  messages:
                    links:
                      related: /trees/d1076e5e-603e-4eb8-9b2e-82b36414a8dd/messages
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
  patch:
    summary: Update a tree
    operationId: updateTree
    parameters:
      - name: treeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/UpdateTreeRequest'
          example:
            data:
              id: d1076e5e-603e-4eb8-9b2e-82b36414a8dd
              type: tree
              attributes:
                name: My Tree
                description: An example tree
                isPrivate: false
    responses:
      '200':
        description: An updated tree
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/TreeResponse'
            example:
              data:
                id: d1076e5e-603e-4eb8-9b2e-82b36414a8dd
                type: tree
                attributes:
                  name: My Tree
                  description: An example tree
                  createdAt: 2020-01-01T00:00:00.000Z
                  updatedAt: 2020-01-01T00:00:00.000Z
                  owner: 6ca0bd34-0f36-4670-8e1e-574011ee9ba4
                  isPrivate: false
                  isDeleted: false
                  forks: 0
                relationships:
                  messages:
                    links:
                      related: /trees/d1076e5e-603e-4eb8-9b2e-82b36414a8dd/messages
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
  delete:
    summary: Delete a tree
    operationId: deleteTree
    parameters:
      - name: treeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '204':
        description: Tree successfully deleted
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
/trees/{treeId}/messages:
  get:
    summary: List messages in a tree
    operationId: getTreeMessages
    parameters:
      - name: treeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: page[number]
        in: query
        description: Page number for pagination
        schema:
          type: integer
      - name: page[size]
        in: query
        description: Number of records per page for pagination
        schema:
          type: integer
      - name: sort
        in: query
        description: Comma-separated field names to sort by. Use -<fieldname> for descending order.
        schema:
          type: string
      - name: filter
        in: query
        description: Field to filter by, in the format filter[<fieldname>][<operator>]=<value>. Operators can be eq (equals), gt (greater than), lt (less than), gte (greater than or equals), lte (less than or equals), ne (not equals).
        style: deepObject
        explode: true
        schema:
          type: object
          additionalProperties:
            type: object
            additionalProperties:
              type: string
    responses:
      '200':
        description: A list of messages in a tree
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/MessagesResponse'
            example:
              data:
                - id: 99fb821d-0ef4-46d1-bcdc-c7af9fee35d8
                  type: message
                  attributes:
                    createdAt: 2021-01-01T00:00:00Z
                    updatedAt: 2021-01-01T00:00:00Z
                    isDeleted: false
                    parent: null
                    role: user
                    content: Hello, world!
                    tokens: 2
                - id: cfda88f6-b377-457c-abd0-2b0d7b3dcbf1
                  type: message
                  attributes:
                    createdAt: 2021-01-01T00:00:00Z
                    updatedAt: 2021-01-01T00:00:00Z
                    isDeleted: false
                    parent: 99fb821d-0ef4-46d1-bcdc-c7af9fee35d8
                    role: assistant
                    content: Hi, I'm a bot!
                    tokens: 4
              links:
                self: /trees/d1076e5e-603e-4eb8-9b2e-82b36414a8dd/messages&page[number]=1&page[size]=10
                first: /trees/d1076e5e-603e-4eb8-9b2e-82b36414a8dd/messages&page[number]=1&page[size]=10
                last: /trees/d1076e5e-603e-4eb8-9b2e-82b36414a8dd/messages&page[number]=1&page[size]=10
                prev: null
                next: null
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
  post:
    summary: Create a new message in a tree
    operationId: createTreeMessage
    parameters:
      - name: treeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/CreateMessageRequest'
          example:
            data:
              type: message
              attributes:
                parent: 99fb821d-0ef4-46d1-bcdc-c7af9fee35d8
                role: user
                content: Hello, world!
    responses:
      '201':
        description: A created message
        headers:
          Location:
            schema:
              type: string
            description: The url of the newly created message
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/MessageResponse'
            example:
              data:
                id: cfda88f6-b377-457c-ab8d-149bcfa94a20
                type: message
                attributes:
                  createdAt: 2021-01-01T00:00:00Z
                  updatedAt: 2021-01-01T00:00:00Z
                  isDeleted: false
                  parent: 99fb821d-0ef4-46d1-bcdc-c7af9fee35d8
                  role: user
                  content: Hello, world!
                  tokens: 2
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
/trees/{treeId}/messages/{msgId}:
  patch:
    summary: Update a message in a tree
    operationId: updateTreeMessage
    parameters:
      - name: treeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: msgId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/UpdateMessageRequest'
          example:
            data:
              id: f47ac10b-58cc-4372-a567-0e02b2c3d479
              type: message
              attributes:
                parent: 69b74bc9-2b5a-4d6e-8a9e-9b8f1e9e45ca
                role: system
                content: You are a bot that says 'Hello, world!'
    responses:
      '200':
        description: An updated message
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/MessageResponse'
            example:
              data:
                id: f47ac10b-58cc-4372-a567-0e02b2c3d479
                type: message
                attributes:
                  createdAt: 2021-01-01T00:00:00Z
                  updatedAt: 2021-01-01T00:00:00Z
                  isDeleted: false
                  parent: 69b74bc9-2b5a-4d6e-8a9e-9b8f1e9e45ca
                  role: system
                  content: You are a bot that says 'Hello, world!'
                  tokens: 8
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
  delete:
    summary: Delete a message in a tree
    operationId: deleteTreeMessage
    parameters:
      - name: treeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: msgId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '204':
        description: Message successfully deleted
      default:
        description: Unexpected errors
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/ErrorsResponse'
